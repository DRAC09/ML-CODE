import pandas as pd
 
df=pd.read_csv('dataset/fuel_consumption_dataset.csv')
df.describe()



import matplotlib.pyplot as plt
 from sklearn.model_selection import train_test_split
 from sklearn.linear_model import LinearRegression
 from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
 import numpy as np
 
# Select features (X) and target (y)
 X = df[['ENGINESIZE', 'CYLINDERS', 'FUELCONSUMPTION_COMB']]
 y = df['CO2EMISSIONS']
 
# Train-test split
 X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
 
# Train linear regression model
 model = LinearRegression()
 model.fit(X_train, y_train)
 
# Predictions
 y_pred = model.predict(X_test)
 
# Metrics
 r2 = r2_score(y_test, y_pred)
 mae = mean_absolute_error(y_test, y_pred)
 mse = mean_squared_error(y_test, y_pred)
 # rmse = np.sqrt(mse)
 
print(" Model Performance Metrics")
 print("RÂ² Score:", r2)
 print("Mean Absolute Error (MAE):", mae)
 print("Mean Squared Error (MSE):", mse)
 # print("Root Mean Squared Error (RMSE):", rmse)
 
 
# Plot Actual vs Predicted
 plt.figure(figsize=(7, 6))
 plt.scatter(y_test, y_pred, alpha=0.6, color='blue', label="Predicted vs Actual")
 plt.plot([y.min(), y.max()], [y.min(), y.max()], color='red', linestyle='--', label="Perfect Prediction")
 plt.xlabel("Actual CO2 Emissions")
 plt.ylabel("Predicted CO2 Emissions")
 plt.title("Actual vs Predicted CO2 Emissions")
 plt.legend()
 plt.grid(True, linestyle="--", alpha=0.6)
 plt.show()





import pandas as pd
 import matplotlib.pyplot as plt
 from sklearn.model_selection import train_test_split
 from sklearn.linear_model import LogisticRegression
 from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, classification_report
 
# Load dataset
 file_path = "dataset/fuel_consumption_dataset.csv"
 df = pd.read_csv(file_path)
 
# Create binary target: High (1) if CO2 > mean, else Low (0)
 threshold = df['CO2EMISSIONS'].mean()
 df['HighEmission'] = (df['CO2EMISSIONS'] > threshold).astype(int)
 
# Features and target
 X = df[['ENGINESIZE', 'CYLINDERS', 'FUELCONSUMPTION_COMB']]
 y = df['HighEmission']
 
# Train-test split
 X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
 
# Logistic Regression model
 model = LogisticRegression(max_iter=2000)
 model.fit(X_train, y_train)
 
# Predictions
 y_pred = model.predict(X_test)
 
# Metrics
 print("Accuracy:", accuracy_score(y_test, y_pred))
 print("Precision:", precision_score(y_test, y_pred))
 print("Recall:", recall_score(y_test, y_pred))
 print("F1 Score:", f1_score(y_test, y_pred))
 
# Detailed classification report
 print("\n Classification Report:")
 print(classification_report(y_test, y_pred))
 
 
# Plot Actual vs Predicted
 plt.figure(figsize=(7, 6))
plt.scatter(y_test, y_pred, alpha=0.6, color='blue', label="Predicted vs Actual")
 plt.plot([y.min(), y.max()], [y.min(), y.max()], color='red', linestyle='--', label="Perfect Prediction")
 plt.xlabel("Actual CO2 Emissions")
 plt.ylabel("Predicted CO2 Emissions")
 plt.title("Actual vs Predicted CO2 Emissions")
 plt.legend()
 plt.grid(True, linestyle="--", alpha=0.6)
 plt.show()




 import pandas as pd
 
# Load the dataset
 df=pd.read_csv('dataset/fuel_consumption_dataset.csv')
 
 
# 1. Display the first 10 rows of the dataset
 query1 = df.head(10)
 
# 2. Show all unique vehicle classes
 query2 = df['VEHICLECLASS'].unique()
 
# 3. Find the average CO2 emissions grouped by fuel type
 query3 = df.groupby('FUELTYPE')['CO2EMISSIONS'].mean()
 
# 4. List all cars from the year 2018
 query4 = df[df['MODELYEAR'] == 2018]
 
# 5. Show top 5 makes with the highest average engine size
 query5 = df.groupby('MAKE')['ENGINESIZE'].mean().sort_values(ascending=False).head(5)
 
# 6. Count the number of cars per cylinder type
 query6 = df['CYLINDERS'].value_counts()
 
# 7. Filter cars where CO2 emissions are greater than 300
 query7 = df[df['CO2EMISSIONS'] > 300]
 
# 8. Find the vehicle with the maximum highway fuel consumption
 query8 = df.loc[df['FUELCONSUMPTION_HWY'].idxmax()]
 
# 9. Group by make and model, and find the average city fuel consumption
 query9 = df.groupby(['MAKE', 'MODEL'])['FUELCONSUMPTION_CITY'].mean()
 
# 10. Find the correlation between engine size and CO2 emissions
 query10 = df[['ENGINESIZE', 'CO2EMISSIONS']].corr().iloc[0,1]
 
# Example to print one of the queries
 
print(query5)
